import{g as oe,p as ne}from"./trade-BY624NMh.js";import{_ as ie,u as re,r as u,k as ue,m as de,Y as pe,c as m,b as o,q as ce,N as L,d as l,w as a,f as n,t as ve,W as me,X as fe,o as c,e as i,x as C,U as _e,v as p,n as h,H as ye,h as ge,Z as be,C as Te,E as U,L as A}from"./index-Dl24hcOp.js";const Ve={class:"market-container"},ke={class:"page-header"},Ce={class:"filter-card"},Ue={class:"filter-row"},xe={class:"filter-item"},we={class:"filter-item"},De={class:"filter-item"},Ee={class:"order-grid"},Le={class:"order-header"},Se={class:"order-body"},Oe={class:"order-price"},qe={class:"price-value"},Be={class:"order-amount"},Ie={class:"amount-value"},Ne={class:"order-total"},$e={class:"total-value"},ze={class:"order-footer"},Fe={class:"user-info"},Pe={class:"user-name"},Me={class:"order-time"},he={class:"order-actions"},Ae={key:0,class:"empty-state"},Qe={key:0,class:"pagination-wrapper"},Ye={__name:"supply-demand",setup(Re){const S=re(),b=u(!1),x=u(!1),O=u([]),w=u(0),f=u(1),q=u(12);let D=null;const _=u(""),y=u(""),E=u(""),g=u(!1),r=u({direction:"SELL",itemType:"QUOTA",price:null,quantity:null}),B=ue(()=>O.value.map(t=>({id:t.id,type:t.direction==="BUY"?"æ±‚è´­":"å‡ºå”®",asset:t.itemType==="QUOTA"?"ç¢³é…é¢":"ç¢³ä¿¡ç”¨",amount:t.quantity?.toLocaleString()||"0",price:t.price?.toFixed(2)||"é¢è®®",year:new Date(t.createTime).getFullYear(),deadline:t.createTime?new Date(t.createTime).toLocaleDateString():"-",user:`ç”¨æˆ·${t.userId}`,status:t.status,rawData:t}))),I=t=>{const e=parseFloat(t.price)||0,d=parseFloat(t.amount?.replace(/,/g,""))||0;return(e*d).toLocaleString("zh-CN",{minimumFractionDigits:2})},v=async()=>{b.value=!0;try{const t={page:f.value,size:q.value};_.value&&(t.type=_.value),y.value&&(t.direction=y.value);const e=await oe(t);e&&e.records&&(O.value=e.records,w.value=e.total||0)}catch(t){console.error("åŠ è½½è®¢å•å¤±è´¥:",t)}finally{b.value=!1}},Q=()=>{f.value=1,v()},Y=()=>{_.value="",y.value="",E.value="",f.value=1,v()},N=()=>{if(!S.userId){U.warning("è¯·å…ˆç™»å½•");return}g.value=!0},R=t=>{A.alert(`è®¢å•ç¼–å·: ${t.id}<br>ç±»å‹: ${t.asset}<br>æ–¹å‘: ${t.type}<br>æ•°é‡: ${t.amount} å¨<br>ä»·æ ¼: Â¥${t.price}/å¨`,"è®¢å•è¯¦æƒ…",{dangerouslyUseHTMLString:!0,confirmButtonText:"å…³é—­"})},H=t=>{A.confirm(`ç¡®è®¤ä¸è¯¥è®¢å•è¿›è¡Œäº¤æ˜“ï¼Ÿ<br>äº¤æ˜“é‡‘é¢: Â¥${I(t)}`,"ç¡®è®¤äº¤æ˜“",{dangerouslyUseHTMLString:!0,confirmButtonText:"ç¡®è®¤",cancelButtonText:"å–æ¶ˆ",type:"info"}).then(()=>{U.success("äº¤æ˜“è¯·æ±‚å·²æäº¤ï¼Œç­‰å¾…å¤„ç†")}).catch(()=>{})},j=async()=>{if(!r.value.price||!r.value.quantity){U.warning("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");return}x.value=!0;try{const t={userId:S.userId,direction:r.value.direction,itemType:r.value.itemType,price:r.value.price,quantity:r.value.quantity,status:"OPEN"};await ne(t),U.success("è®¢å•å‘å¸ƒæˆåŠŸï¼Œç­‰å¾…æ’®åˆ"),g.value=!1,r.value={direction:"SELL",itemType:"QUOTA",price:null,quantity:null},v()}catch(t){console.error("å‘å¸ƒè®¢å•å¤±è´¥:",t)}finally{x.value=!1}},K=t=>{f.value=t,v()};return de(()=>{v(),D=setInterval(()=>{v()},1e4)}),pe(()=>{D&&clearInterval(D)}),(t,e)=>{const d=n("el-button"),T=n("el-icon"),W=n("el-input"),V=n("el-option"),$=n("el-select"),X=n("el-tag"),Z=n("el-avatar"),G=n("el-empty"),J=n("el-pagination"),z=n("el-radio-button"),F=n("el-radio-group"),k=n("el-form-item"),P=n("el-radio"),M=n("el-input-number"),ee=n("el-alert"),le=n("el-form"),te=n("el-dialog"),ae=ve("loading");return c(),m("div",Ve,[o("div",ke,[e[10]||(e[10]=o("div",{class:"header-content"},[o("h1",null,"ä¾›éœ€å¤§å…"),o("p",null,"å‘å¸ƒæ‚¨çš„ç¢³äº¤æ˜“éœ€æ±‚ï¼Œç³»ç»Ÿè‡ªåŠ¨æ’®åˆæœ€ä¼˜ä»·æ ¼")],-1)),l(d,{type:"primary",size:"large",icon:"Plus",class:"publish-btn",onClick:N},{default:a(()=>[...e[9]||(e[9]=[i(" å‘å¸ƒè®¢å• ",-1)])]),_:1})]),o("div",Ce,[o("div",Ue,[o("div",xe,[e[11]||(e[11]=o("span",{class:"filter-label"},"å…³é”®å­—",-1)),l(W,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=s=>E.value=s),placeholder:"æœç´¢å…³é”®å­—",clearable:"",class:"filter-input"},{prefix:a(()=>[l(T,null,{default:a(()=>[l(C(_e))]),_:1})]),_:1},8,["modelValue"])]),o("div",we,[e[12]||(e[12]=o("span",{class:"filter-label"},"äº¤æ˜“æ–¹å‘",-1)),l($,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=s=>y.value=s),placeholder:"å…¨éƒ¨",clearable:"",class:"filter-select"},{default:a(()=>[l(V,{label:"å‡ºå”®",value:"SELL"}),l(V,{label:"æ±‚è´­",value:"BUY"})]),_:1},8,["modelValue"])]),o("div",De,[e[13]||(e[13]=o("span",{class:"filter-label"},"èµ„äº§ç±»å‹",-1)),l($,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=s=>_.value=s),placeholder:"å…¨éƒ¨",clearable:"",class:"filter-select"},{default:a(()=>[l(V,{label:"ç¢³é…é¢ (QUOTA)",value:"QUOTA"}),l(V,{label:"ç¢³ä¿¡ç”¨ (CREDIT)",value:"CREDIT"})]),_:1},8,["modelValue"])]),l(d,{type:"primary",icon:"Search",onClick:Q},{default:a(()=>[...e[14]||(e[14]=[i("ç­›é€‰",-1)])]),_:1}),l(d,{icon:"Refresh",onClick:Y},{default:a(()=>[...e[15]||(e[15]=[i("é‡ç½®",-1)])]),_:1})])]),ce((c(),m("div",Ee,[(c(!0),m(me,null,fe(B.value,s=>(c(),m("div",{class:"order-card",key:s.id},[o("div",{class:h(["order-badge",s.type==="å‡ºå”®"?"sell":"buy"])},p(s.type),3),o("div",Le,[o("div",{class:h(["asset-tag",s.asset==="ç¢³é…é¢"?"quota":"credit"])},p(s.asset),3),l(X,{size:"small",type:s.status==="OPEN"?"success":"info",effect:"light"},{default:a(()=>[i(p(s.status==="OPEN"?"å¾…æ’®åˆ":"å·²æˆäº¤"),1)]),_:2},1032,["type"])]),o("div",Se,[o("div",Oe,[o("span",qe,"Â¥"+p(s.price),1),e[16]||(e[16]=o("span",{class:"price-unit"},"/å¨",-1))]),o("div",Be,[e[18]||(e[18]=o("span",{class:"amount-label"},"äº¤æ˜“æ•°é‡",-1)),o("span",Ie,[i(p(s.amount)+" ",1),e[17]||(e[17]=o("small",null,"å¨",-1))])]),o("div",Ne,[e[19]||(e[19]=o("span",{class:"total-label"},"è®¢å•æ€»é¢",-1)),o("span",$e,"Â¥"+p(I(s)),1)])]),o("div",ze,[o("div",Fe,[l(Z,{size:28,class:"user-avatar"},{default:a(()=>[i(p(s.user.slice(-1)),1)]),_:2},1024),o("span",Pe,p(s.user),1)]),o("div",Me,[l(T,null,{default:a(()=>[l(C(ye))]),_:1}),o("span",null,p(s.deadline),1)])]),o("div",he,[l(d,{text:"",type:"primary",onClick:se=>R(s)},{default:a(()=>[...e[20]||(e[20]=[i("æŸ¥çœ‹è¯¦æƒ…",-1)])]),_:1},8,["onClick"]),s.status==="OPEN"?(c(),ge(d,{key:0,text:"",type:"success",onClick:se=>H(s)},{default:a(()=>[...e[21]||(e[21]=[i("å¿«é€Ÿäº¤æ˜“",-1)])]),_:1},8,["onClick"])):L("",!0)])]))),128)),!b.value&&B.value.length===0?(c(),m("div",Ae,[l(G,{description:"æš‚æ— è®¢å•æ•°æ®"},{image:a(()=>[...e[22]||(e[22]=[o("div",{class:"empty-icon"},"ğŸ“‹",-1)])]),default:a(()=>[l(d,{type:"primary",onClick:N},{default:a(()=>[...e[23]||(e[23]=[i("ç«‹å³å‘å¸ƒè®¢å•",-1)])]),_:1})]),_:1})])):L("",!0)])),[[ae,b.value]]),w.value>0?(c(),m("div",Qe,[l(J,{background:"",layout:"total, prev, pager, next, jumper",total:w.value,"page-size":q.value,"current-page":f.value,onCurrentChange:K},null,8,["total","page-size","current-page"])])):L("",!0),l(te,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=s=>g.value=s),title:"å‘å¸ƒäº¤æ˜“è®¢å•",width:"520px",class:"publish-dialog"},{footer:a(()=>[l(d,{onClick:e[7]||(e[7]=s=>g.value=!1)},{default:a(()=>[...e[30]||(e[30]=[i("å–æ¶ˆ",-1)])]),_:1}),l(d,{type:"primary",onClick:j,loading:x.value},{default:a(()=>[...e[31]||(e[31]=[i("ç¡®è®¤å‘å¸ƒ",-1)])]),_:1},8,["loading"])]),default:a(()=>[l(le,{model:r.value,"label-width":"100px",class:"publish-form"},{default:a(()=>[l(k,{label:"äº¤æ˜“æ–¹å‘"},{default:a(()=>[l(F,{modelValue:r.value.direction,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.direction=s),class:"direction-group"},{default:a(()=>[l(z,{label:"SELL"},{default:a(()=>[l(T,null,{default:a(()=>[l(C(be))]),_:1}),e[24]||(e[24]=i(" å‡ºå”® ",-1))]),_:1}),l(z,{label:"BUY"},{default:a(()=>[l(T,null,{default:a(()=>[l(C(Te))]),_:1}),e[25]||(e[25]=i(" æ±‚è´­ ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"èµ„äº§ç±»å‹"},{default:a(()=>[l(F,{modelValue:r.value.itemType,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.itemType=s),class:"type-group"},{default:a(()=>[l(P,{label:"QUOTA"},{default:a(()=>[...e[26]||(e[26]=[i("ç¢³é…é¢",-1)])]),_:1}),l(P,{label:"CREDIT"},{default:a(()=>[...e[27]||(e[27]=[i("ç¢³ä¿¡ç”¨",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"ä»·æ ¼"},{default:a(()=>[l(M,{modelValue:r.value.price,"onUpdate:modelValue":e[5]||(e[5]=s=>r.value.price=s),min:0,precision:2,step:.5,placeholder:"è¯·è¾“å…¥ä»·æ ¼"},{suffix:a(()=>[...e[28]||(e[28]=[i("å…ƒ/å¨",-1)])]),_:1},8,["modelValue"])]),_:1}),l(k,{label:"æ•°é‡"},{default:a(()=>[l(M,{modelValue:r.value.quantity,"onUpdate:modelValue":e[6]||(e[6]=s=>r.value.quantity=s),min:1,step:10,placeholder:"è¯·è¾“å…¥æ•°é‡"},{suffix:a(()=>[...e[29]||(e[29]=[i("å¨",-1)])]),_:1},8,["modelValue"])]),_:1}),l(ee,{title:"è®¢å•å‘å¸ƒåå°†è¿›å…¥æ’®åˆé˜Ÿåˆ—ï¼Œç³»ç»Ÿæ¯5ç§’è‡ªåŠ¨åŒ¹é…ä¸€æ¬¡æœ€ä¼˜ä»·æ ¼",type:"info",closable:!1,"show-icon":"",class:"tip-alert"})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ke=ie(Ye,[["__scopeId","data-v-1107a36e"]]);export{Ke as default};
