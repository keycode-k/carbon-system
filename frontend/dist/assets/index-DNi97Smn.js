import{_ as ee,r as v,m as te,c as d,d as e,w as a,f as r,E as ae,g as le,t as oe,o as s,a0 as ne,e as u,x as f,U as se,q as re,h as C,N as x,W as M,X as S,b as n,v as c,a1 as ce,a2 as ie,a3 as I,H as ue,n as R}from"./index-Dl24hcOp.js";import{g as U}from"./news-DvoziJha.js";const de={class:"app-container"},_e={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ve={key:1},pe=["onClick"],me={class:"news-content"},ge={class:"news-header"},fe={class:"news-title"},ye={class:"news-abstract"},he={class:"news-meta"},be={key:0},we=["src"],ke={class:"category-grid"},Ce=["onClick"],xe={class:"category-name"},ze={class:"category-count"},Ne=["onClick"],Ve={class:"hot-content"},De={class:"hot-title"},Le={class:"hot-meta"},Me={__name:"index",setup(Se){const j=le(),i=v({title:"",category:""}),z=v([]),T=v([]),N=v(!1),h=v(0),m=v(1),V=v(10),F=v([{label:"政策法规",value:"政策法规",count:0},{label:"行业动态",value:"行业动态",count:0},{label:"技术创新",value:"技术创新",count:0},{label:"市场分析",value:"市场分析",count:0}]),y=async()=>{N.value=!0;try{const o={page:m.value,size:V.value,title:i.value.title||void 0,category:i.value.category||void 0,status:1},l=await U(o);console.log("News List Response:",l),z.value=l.records||[],h.value=l.total||0}catch(o){ae.error("加载新闻列表失败"),console.error(o)}finally{N.value=!1}},H=async()=>{try{const l=((await U({page:1,size:5,status:1})).records||[]).sort((b,p)=>(p.viewCount||0)-(b.viewCount||0));T.value=l.slice(0,5)}catch(o){console.error("加载热门新闻失败",o)}},D=()=>{m.value=1,y()},P=()=>{i.value={title:"",category:""},m.value=1,y()},q=o=>{m.value=o,y()},W=o=>{V.value=o,m.value=1,y()},X=o=>{i.value.category===o?i.value.category="":i.value.category=o,D()},B=o=>{j.push(`/news/detail/${o}`)},A=o=>{if(!o)return"";const l=new Date(o),p=new Date-l,_=Math.floor(p/(1e3*60*60*24));return _===0?"今天":_===1?"昨天":_<7?`${_}天前`:l.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},G=o=>({政策法规:"danger",行业动态:"primary",技术创新:"success",市场分析:"warning"})[o]||"info";return te(()=>{y(),H()}),(o,l)=>{const b=r("el-input"),p=r("el-form-item"),_=r("el-option"),J=r("el-select"),g=r("el-icon"),$=r("el-button"),K=r("el-form"),w=r("el-card"),L=r("el-tag"),O=r("el-empty"),Q=r("el-pagination"),E=r("el-col"),Y=r("el-row"),Z=oe("loading");return s(),d("div",de,[e(w,{shadow:"never",style:{"margin-bottom":"20px"}},{default:a(()=>[e(K,{inline:!0,model:i.value,onSubmit:ne(D,["prevent"])},{default:a(()=>[e(p,{label:"关键词"},{default:a(()=>[e(b,{modelValue:i.value.title,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value.title=t),placeholder:"请输入新闻标题",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(p,{label:"分类"},{default:a(()=>[e(J,{modelValue:i.value.category,"onUpdate:modelValue":l[1]||(l[1]=t=>i.value.category=t),placeholder:"全部分类",clearable:"",style:{width:"150px"}},{default:a(()=>[e(_,{label:"政策法规",value:"政策法规"}),e(_,{label:"行业动态",value:"行业动态"}),e(_,{label:"技术创新",value:"技术创新"}),e(_,{label:"市场分析",value:"市场分析"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e($,{type:"primary",onClick:D},{default:a(()=>[e(g,null,{default:a(()=>[e(f(se))]),_:1}),l[2]||(l[2]=u(" 搜索 ",-1))]),_:1}),e($,{onClick:P},{default:a(()=>[...l[3]||(l[3]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Y,{gutter:20},{default:a(()=>[e(E,{span:16},{default:a(()=>[re((s(),C(w,{shadow:"hover"},{header:a(()=>[n("div",_e,[l[4]||(l[4]=n("span",null,"碳资讯动态",-1)),e(L,null,{default:a(()=>[u("共 "+c(h.value)+" 条",1)]),_:1})])]),default:a(()=>[z.value.length===0?(s(),C(O,{key:0,description:"暂无新闻数据"})):(s(),d("div",ve,[(s(!0),d(M,null,S(z.value,t=>(s(),d("div",{key:t.id,class:"news-item",onClick:k=>B(t.id)},[n("div",me,[n("div",ge,[n("div",fe,[t.isTop===1?(s(),C(L,{key:0,type:"danger",size:"small",style:{"margin-right":"8px"}},{default:a(()=>[...l[5]||(l[5]=[u("置顶",-1)])]),_:1})):x("",!0),u(" "+c(t.title),1)])]),n("div",ye,c(t.summary||"暂无摘要"),1),n("div",he,[e(L,{size:"small",type:G(t.category)},{default:a(()=>[u(c(t.category),1)]),_:2},1032,["type"]),n("span",null,[e(g,null,{default:a(()=>[e(f(ce))]),_:1}),u(" "+c(t.author),1)]),t.source?(s(),d("span",be,[e(g,null,{default:a(()=>[e(f(ie))]),_:1}),u(" "+c(t.source),1)])):x("",!0),n("span",null,[e(g,null,{default:a(()=>[e(f(I))]),_:1}),u(" "+c(t.viewCount||0),1)]),n("span",null,[e(g,null,{default:a(()=>[e(f(ue))]),_:1}),u(" "+c(A(t.publishTime)),1)])])]),t.coverImage?(s(),d("img",{key:0,src:t.coverImage,class:"news-thumb"},null,8,we)):x("",!0)],8,pe))),128))])),h.value>0?(s(),C(Q,{key:2,background:"",layout:"total, prev, pager, next, sizes",total:h.value,"page-size":V.value,"current-page":m.value,"page-sizes":[10,20,50],onCurrentChange:q,onSizeChange:W,style:{"margin-top":"20px","justify-content":"center"}},null,8,["total","page-size","current-page"])):x("",!0)]),_:1})),[[Z,N.value]])]),_:1}),e(E,{span:8},{default:a(()=>[e(w,{header:"分类浏览",style:{"margin-bottom":"20px"}},{default:a(()=>[n("div",ke,[(s(!0),d(M,null,S(F.value,t=>(s(),d("div",{key:t.value,class:R(["category-item",{active:i.value.category===t.value}]),onClick:k=>X(t.value)},[n("div",xe,c(t.label),1),n("div",ze,c(t.count),1)],10,Ce))),128))])]),_:1}),e(w,{header:"热门资讯"},{default:a(()=>[(s(!0),d(M,null,S(T.value,(t,k)=>(s(),d("div",{key:t.id,class:"hot-news-item",onClick:Te=>B(t.id)},[n("div",{class:R(["hot-rank","rank-"+(k+1)])},c(k+1),3),n("div",Ve,[n("div",De,c(t.title),1),n("div",Le,[n("span",null,[e(g,null,{default:a(()=>[e(f(I))]),_:1}),u(" "+c(t.viewCount),1)])])])],8,Ne))),128))]),_:1})]),_:1})]),_:1})])}}},Ee=ee(Me,[["__scopeId","data-v-a1e05b4c"]]);export{Ee as default};
