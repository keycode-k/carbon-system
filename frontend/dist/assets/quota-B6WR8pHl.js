import{a as B,b as q}from"./assets-QRNHCeCq.js";import{_ as I,r as _,k as x,s as L,i as M,l as N,m as O,c as z,d as t,w as l,f as o,E as R,o as y,b as a,e as m,g as D,t as r,n as T,v as U}from"./index-CAroDxw1.js";import"./request-xGXa7hEd.js";const Y={class:"app-container"},$={class:"compliance-header"},j={class:"compliance-status"},A={class:"stat-value"},F={class:"stat-value"},G={class:"progress-section"},H={class:"progress-info"},J={__name:"quota",setup(K){const d=_("2025"),s=_({totalQuota:0,verifiedEmission:0,status:0}),f=_(!1),g=_([]),p=x(()=>s.value.totalQuota?s.value.totalQuota-s.value.verifiedEmission:0),h=x(()=>{if(!s.value.totalQuota||s.value.totalQuota===0)return 0;let i=Math.round(s.value.verifiedEmission/s.value.totalQuota*100);return i>100?100:i}),k=async()=>{f.value=!0;try{const e=await B(1,d.value);if(e&&e.id){s.value=e;const u=await q(e.id);u&&(g.value=u.map(v=>({...v,date:v.changeDate})))}else s.value={totalQuota:0,verifiedEmission:0,status:0},g.value=[],R.info(`${d.value}年暂无配额数据`)}catch(i){console.error(i)}finally{f.value=!1}};return L(d,()=>{k()}),M(()=>{k()}),(i,e)=>{const u=o("el-option"),v=o("el-select"),b=o("el-tag"),w=o("el-col"),E=o("el-row"),C=o("el-progress"),Q=o("el-card"),c=o("el-table-column"),S=o("el-table"),V=O("loading");return N((y(),z("div",Y,[t(Q,{shadow:"never",class:"compliance-card"},{default:l(()=>[a("div",$,[a("div",null,[e[1]||(e[1]=a("span",{class:"label"},"当前履约年度：",-1)),t(v,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=n=>d.value=n),placeholder:"Select",style:{width:"100px","font-weight":"bold"}},{default:l(()=>[t(u,{label:"2025",value:"2025"}),t(u,{label:"2024",value:"2024"}),t(u,{label:"2023",value:"2023"})]),_:1},8,["modelValue"])]),a("div",j,[e[4]||(e[4]=m(" 履约状态： ",-1)),s.value.status===1?(y(),D(b,{key:0,type:"success",effect:"dark"},{default:l(()=>[...e[2]||(e[2]=[m("履约完成",-1)])]),_:1})):(y(),D(b,{key:1,type:"danger",effect:"dark"},{default:l(()=>[...e[3]||(e[3]=[m("未履约",-1)])]),_:1}))])]),t(E,{gutter:40,style:{"margin-top":"30px"}},{default:l(()=>[t(w,{span:8,class:"stat-col"},{default:l(()=>[a("div",A,r(s.value.totalQuota?.toLocaleString()||0),1),e[5]||(e[5]=a("div",{class:"stat-label"},"发放总配额 (tCO2e)",-1))]),_:1}),t(w,{span:8,class:"stat-col"},{default:l(()=>[a("div",F,r(s.value.verifiedEmission?.toLocaleString()||0),1),e[6]||(e[6]=a("div",{class:"stat-label"},"核查排放量 (tCO2e)",-1))]),_:1}),t(w,{span:8,class:"stat-col"},{default:l(()=>[a("div",{class:T(["stat-value",{positive:p.value>=0,negative:p.value<0}])},r(p.value>0?"+":"")+" "+r(p.value.toLocaleString()),3),e[7]||(e[7]=a("div",{class:"stat-label"},"盈余配额 (tCO2e)",-1))]),_:1})]),_:1}),a("div",G,[a("div",H,[e[8]||(e[8]=a("span",null,"配额使用率",-1)),a("span",null,r(h.value)+"%",1)]),t(C,{"text-inside":!0,"stroke-width":20,percentage:h.value,status:"warning"},null,8,["percentage"])])]),_:1}),t(Q,{shadow:"hover",header:"配额明细记录",style:{"margin-top":"20px"}},{default:l(()=>[t(S,{data:g.value,border:"",stripe:""},{default:l(()=>[t(c,{prop:"date",label:"发放/变动日期",width:"180"}),t(c,{prop:"type",label:"类型",width:"150"},{default:l(n=>[t(b,{type:n.row.type==="发放"?"success":"warning"},{default:l(()=>[m(r(n.row.type),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"amount",label:"变动数量",align:"right"},{default:l(n=>[a("span",{style:U({color:n.row.amount>0?"green":"red"})},r(n.row.amount>0?"+":"")+r(n.row.amount),5)]),_:1}),t(c,{prop:"balance",label:"结余",align:"right"}),t(c,{prop:"remark",label:"备注","show-overflow-tooltip":""})]),_:1},8,["data"])]),_:1})])),[[V,f.value]])}}},Z=I(J,[["__scopeId","data-v-baca3deb"]]);export{Z as default};
