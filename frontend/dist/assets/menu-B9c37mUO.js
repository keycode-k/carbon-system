import{_ as W,r as y,a as X,k as Y,m as Z,c as h,d as t,w as o,f as d,t as ee,o as r,e as u,x as D,B as le,a8 as te,v as $,q as oe,h as s,N as p,a9 as ne,L as ae,E as w}from"./index-Dl24hcOp.js";import{f as ue,m as de,n as re,o as se}from"./system-DaJnZECp.js";const me={class:"app-container"},ie={__name:"menu",setup(pe){const k=y([]),T=y(!1),c=y(!0),v=y(!1),N=y("新增菜单"),M=y(null),C=y(!1),l=X({id:null,parentId:0,menuName:"",menuPath:"",component:"",permission:"",menuType:"C",icon:"",orderNum:0,status:1,visible:1}),q={menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],menuType:[{required:!0,message:"请选择菜单类型",trigger:"change"}]},L=Y(()=>[{id:0,menuName:"顶级菜单",children:k.value}]),V=async()=>{try{T.value=!0;const a=await ue();a&&(k.value=a)}catch(a){console.error("加载菜单列表失败:",a)}finally{T.value=!1}},R=()=>{c.value=!c.value,V()},S=()=>{l.id=null,l.parentId=0,l.menuName="",l.menuPath="",l.component="",l.permission="",l.menuType="C",l.icon="",l.orderNum=0,l.status=1,l.visible=1},I=a=>{S(),l.parentId=a,N.value="新增菜单",v.value=!0},A=a=>{N.value="编辑菜单",l.id=a.id,l.parentId=a.parentId,l.menuName=a.menuName,l.menuPath=a.menuPath,l.component=a.component,l.permission=a.permission,l.menuType=a.menuType,l.icon=a.icon,l.orderNum=a.orderNum,l.status=a.status,l.visible=a.visible,v.value=!0},O=async()=>{try{await M.value.validate(),C.value=!0,l.id?(await re(l.id,l),w.success("更新成功")):(await se(l),w.success("创建成功")),v.value=!1,V()}catch(a){console.error("提交失败:",a)}finally{C.value=!1}},j=a=>{ae.confirm(`确定要删除菜单"${a.menuName}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await de(a.id),w.success("删除成功"),V()}catch{w.error("删除失败，可能存在子菜单")}}).catch(()=>{})};return Z(()=>{V()}),(a,e)=>{const x=d("el-icon"),f=d("el-button"),m=d("el-form-item"),P=d("el-form"),B=d("el-card"),i=d("el-table-column"),g=d("el-tag"),z=d("el-table"),G=d("el-tree-select"),_=d("el-radio"),U=d("el-radio-group"),b=d("el-input"),H=d("el-input-number"),E=d("el-col"),J=d("el-row"),K=d("el-dialog"),Q=ee("loading");return r(),h("div",me,[t(B,{class:"search-card"},{default:o(()=>[t(P,{inline:!0},{default:o(()=>[t(m,null,{default:o(()=>[t(f,{type:"success",onClick:e[0]||(e[0]=n=>I(0))},{default:o(()=>[t(x,null,{default:o(()=>[t(D(le))]),_:1}),e[13]||(e[13]=u(" 新增菜单 ",-1))]),_:1}),t(f,{onClick:R},{default:o(()=>[t(x,null,{default:o(()=>[t(D(te))]),_:1}),u(" "+$(c.value?"折叠":"展开"),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(B,null,{default:o(()=>[oe((r(),s(z,{data:k.value,"row-key":"id",border:"","tree-props":{children:"children"},"default-expand-all":c.value},{default:o(()=>[t(i,{prop:"menuName",label:"菜单名称","min-width":"200"}),t(i,{prop:"icon",label:"图标",width:"100"},{default:o(n=>[n.row.icon?(r(),s(x,{key:0},{default:o(()=>[(r(),s(ne(n.row.icon)))]),_:2},1024)):p("",!0)]),_:1}),t(i,{prop:"menuType",label:"类型",width:"100"},{default:o(n=>[n.row.menuType==="M"?(r(),s(g,{key:0,type:"primary"},{default:o(()=>[...e[14]||(e[14]=[u("目录",-1)])]),_:1})):n.row.menuType==="C"?(r(),s(g,{key:1,type:"success"},{default:o(()=>[...e[15]||(e[15]=[u("菜单",-1)])]),_:1})):n.row.menuType==="F"?(r(),s(g,{key:2,type:"warning"},{default:o(()=>[...e[16]||(e[16]=[u("按钮",-1)])]),_:1})):p("",!0)]),_:1}),t(i,{prop:"menuPath",label:"路由路径",width:"180","show-overflow-tooltip":""}),t(i,{prop:"component",label:"组件路径",width:"180","show-overflow-tooltip":""}),t(i,{prop:"permission",label:"权限标识",width:"180","show-overflow-tooltip":""}),t(i,{prop:"orderNum",label:"排序",width:"80"}),t(i,{prop:"status",label:"状态",width:"80"},{default:o(n=>[t(g,{type:n.row.status===1?"success":"danger"},{default:o(()=>[u($(n.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(i,{label:"操作",width:"200",fixed:"right"},{default:o(n=>[n.row.menuType!=="F"?(r(),s(f,{key:0,link:"",type:"primary",onClick:F=>I(n.row.id)},{default:o(()=>[...e[17]||(e[17]=[u("新增",-1)])]),_:1},8,["onClick"])):p("",!0),t(f,{link:"",type:"primary",onClick:F=>A(n.row)},{default:o(()=>[...e[18]||(e[18]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(f,{link:"",type:"danger",onClick:F=>j(n.row)},{default:o(()=>[...e[19]||(e[19]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","default-expand-all"])),[[Q,T.value]])]),_:1}),t(K,{modelValue:v.value,"onUpdate:modelValue":e[12]||(e[12]=n=>v.value=n),title:N.value,width:"600px"},{footer:o(()=>[t(f,{onClick:e[11]||(e[11]=n=>v.value=!1)},{default:o(()=>[...e[27]||(e[27]=[u("取消",-1)])]),_:1}),t(f,{type:"primary",onClick:O,loading:C.value},{default:o(()=>[...e[28]||(e[28]=[u("确定",-1)])]),_:1},8,["loading"])]),default:o(()=>[t(P,{ref_key:"formRef",ref:M,model:l,rules:q,"label-width":"100px"},{default:o(()=>[t(m,{label:"上级菜单"},{default:o(()=>[t(G,{modelValue:l.parentId,"onUpdate:modelValue":e[1]||(e[1]=n=>l.parentId=n),data:L.value,props:{label:"menuName",children:"children",value:"id"},"check-strictly":"","render-after-expand":!1,placeholder:"选择上级菜单",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1}),t(m,{label:"菜单类型",prop:"menuType"},{default:o(()=>[t(U,{modelValue:l.menuType,"onUpdate:modelValue":e[2]||(e[2]=n=>l.menuType=n)},{default:o(()=>[t(_,{value:"M"},{default:o(()=>[...e[20]||(e[20]=[u("目录",-1)])]),_:1}),t(_,{value:"C"},{default:o(()=>[...e[21]||(e[21]=[u("菜单",-1)])]),_:1}),t(_,{value:"F"},{default:o(()=>[...e[22]||(e[22]=[u("按钮",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"菜单名称",prop:"menuName"},{default:o(()=>[t(b,{modelValue:l.menuName,"onUpdate:modelValue":e[3]||(e[3]=n=>l.menuName=n),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),l.menuType!=="F"?(r(),s(m,{key:0,label:"路由地址",prop:"menuPath"},{default:o(()=>[t(b,{modelValue:l.menuPath,"onUpdate:modelValue":e[4]||(e[4]=n=>l.menuPath=n),placeholder:"请输入路由地址，如：/system/user"},null,8,["modelValue"])]),_:1})):p("",!0),l.menuType==="C"?(r(),s(m,{key:1,label:"组件路径",prop:"component"},{default:o(()=>[t(b,{modelValue:l.component,"onUpdate:modelValue":e[5]||(e[5]=n=>l.component=n),placeholder:"请输入组件路径，如：system/user"},null,8,["modelValue"])]),_:1})):p("",!0),l.menuType!=="M"?(r(),s(m,{key:2,label:"权限标识",prop:"permission"},{default:o(()=>[t(b,{modelValue:l.permission,"onUpdate:modelValue":e[6]||(e[6]=n=>l.permission=n),placeholder:"请输入权限标识，如：system:user:list"},null,8,["modelValue"])]),_:1})):p("",!0),l.menuType!=="F"?(r(),s(m,{key:3,label:"菜单图标"},{default:o(()=>[t(b,{modelValue:l.icon,"onUpdate:modelValue":e[7]||(e[7]=n=>l.icon=n),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1})):p("",!0),t(J,null,{default:o(()=>[t(E,{span:12},{default:o(()=>[t(m,{label:"排序号"},{default:o(()=>[t(H,{modelValue:l.orderNum,"onUpdate:modelValue":e[8]||(e[8]=n=>l.orderNum=n),min:0,max:999},null,8,["modelValue"])]),_:1})]),_:1}),t(E,{span:12},{default:o(()=>[t(m,{label:"状态"},{default:o(()=>[t(U,{modelValue:l.status,"onUpdate:modelValue":e[9]||(e[9]=n=>l.status=n)},{default:o(()=>[t(_,{value:1},{default:o(()=>[...e[23]||(e[23]=[u("启用",-1)])]),_:1}),t(_,{value:0},{default:o(()=>[...e[24]||(e[24]=[u("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l.menuType!=="F"?(r(),s(m,{key:4,label:"显示状态"},{default:o(()=>[t(U,{modelValue:l.visible,"onUpdate:modelValue":e[10]||(e[10]=n=>l.visible=n)},{default:o(()=>[t(_,{value:1},{default:o(()=>[...e[25]||(e[25]=[u("显示",-1)])]),_:1}),t(_,{value:0},{default:o(()=>[...e[26]||(e[26]=[u("隐藏",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):p("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye=W(ie,[["__scopeId","data-v-048178c7"]]);export{ye as default};
