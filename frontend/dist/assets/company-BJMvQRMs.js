import{s as N}from"./request-xGXa7hEd.js";import{_ as K,r as m,a as W,i as X,c as U,g as f,q as _,d as t,f as r,w as l,o as d,e as p,b as g,t as v,E as T}from"./index-CAroDxw1.js";function Y(c){return N({url:`/api/company/info/${c}`,method:"get"})}function Z(c){return N({url:"/api/company/submit",method:"post",data:c})}function ee(c){return N({url:"/api/company/draft",method:"post",data:c})}const te={class:"app-container"},le={key:0},ae={key:1},se={__name:"company",setup(c){const y=m(null),a=m(null),q=m(!1),h=m(!1),C=m(!1),s=W({userId:1,companyName:"",creditCode:"",legalPerson:"",address:"",phone:"",registeredCapital:"",establishDate:null,businessScope:"",licenseUrl:""}),P={companyName:[{required:!0,message:"请输入企业全称",trigger:"blur"}],creditCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{len:18,message:"信用代码必须为18位",trigger:"blur"}],legalPerson:[{required:!0,message:"请输入法人代表",trigger:"blur"}],address:[{required:!0,message:"请输入企业地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入有效的电话号码",trigger:"blur"}]},k=async()=>{try{const e=await Y(1);e&&(a.value=e,q.value=!0,Object.assign(s,{userId:e.userId,companyName:e.companyName,creditCode:e.creditCode,legalPerson:e.legalPerson,address:e.address||"",phone:e.phone||"",registeredCapital:e.registeredCapital||"",establishDate:e.establishDate||null,businessScope:e.businessScope||"",licenseUrl:e.licenseUrl||""}))}catch{}},z=async()=>{y.value&&await y.value.validate(async n=>{if(n){h.value=!0;try{await Z(s),T.success("提交成功，等待审核"),await k()}catch{}finally{h.value=!1}}})},A=async()=>{C.value=!0;try{await ee(s),T.success("草稿保存成功"),await k()}catch{}finally{C.value=!1}},B=()=>{y.value?.resetFields()},E=()=>{if(!a.value)return"您还未完成企业实名认证，大部分交易功能受限";switch(a.value.status){case 0:return"企业信息已保存为草稿，请完善信息后提交审核";case 1:return"您的企业认证正在审核中，请耐心等待";case 3:return"您的企业认证已被驳回，请修改后重新提交";default:return""}},R=()=>!a.value||a.value.status===0?"warning":a.value.status===1?"info":a.value.status===3?"error":"success",$=n=>({0:"未认证",1:"审核中",2:"已认证",3:"已驳回"})[n]||"未知",F=n=>({0:"info",1:"warning",2:"success",3:"danger"})[n]||"info",j=()=>!a.value||a.value.status===0?0:a.value.status===1?1:a.value.status===2?4:a.value.status===3?1:0,D=n=>n?new Date(n).toLocaleString("zh-CN"):"-";return X(()=>{k()}),(n,e)=>{const S=r("el-alert"),i=r("el-input"),u=r("el-form-item"),L=r("el-date-picker"),x=r("el-button"),M=r("el-form"),b=r("el-card"),I=r("el-col"),Q=r("el-tag"),V=r("el-descriptions-item"),O=r("el-descriptions"),G=r("el-empty"),w=r("el-step"),H=r("el-steps"),J=r("el-row");return d(),U("div",te,[a.value&&a.value.status!==2?(d(),f(S,{key:0,title:E(),type:R(),"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title","type"])):_("",!0),t(J,{gutter:20},{default:l(()=>[t(I,{span:16},{default:l(()=>[t(b,{shadow:"hover"},{header:l(()=>[g("span",null,v(q.value?"企业信息编辑":"企业认证表单"),1)]),default:l(()=>[t(M,{ref_key:"formRef",ref:y,model:s,rules:P,"label-width":"140px",style:{"max-width":"600px",padding:"20px 0"}},{default:l(()=>[t(u,{label:"企业全称",prop:"companyName"},{default:l(()=>[t(i,{modelValue:s.companyName,"onUpdate:modelValue":e[0]||(e[0]=o=>s.companyName=o),placeholder:"请输入营业执照上的全称"},null,8,["modelValue"])]),_:1}),t(u,{label:"统一社会信用代码",prop:"creditCode"},{default:l(()=>[t(i,{modelValue:s.creditCode,"onUpdate:modelValue":e[1]||(e[1]=o=>s.creditCode=o),placeholder:"18位信用代码",maxlength:"18"},null,8,["modelValue"])]),_:1}),t(u,{label:"法人代表",prop:"legalPerson"},{default:l(()=>[t(i,{modelValue:s.legalPerson,"onUpdate:modelValue":e[2]||(e[2]=o=>s.legalPerson=o),placeholder:"请输入法人姓名"},null,8,["modelValue"])]),_:1}),t(u,{label:"企业地址",prop:"address"},{default:l(()=>[t(i,{modelValue:s.address,"onUpdate:modelValue":e[3]||(e[3]=o=>s.address=o),placeholder:"请输入企业注册地址"},null,8,["modelValue"])]),_:1}),t(u,{label:"联系电话",prop:"phone"},{default:l(()=>[t(i,{modelValue:s.phone,"onUpdate:modelValue":e[4]||(e[4]=o=>s.phone=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),t(u,{label:"注册资本"},{default:l(()=>[t(i,{modelValue:s.registeredCapital,"onUpdate:modelValue":e[5]||(e[5]=o=>s.registeredCapital=o),placeholder:"例如：5000万元"},null,8,["modelValue"])]),_:1}),t(u,{label:"成立日期"},{default:l(()=>[t(L,{modelValue:s.establishDate,"onUpdate:modelValue":e[6]||(e[6]=o=>s.establishDate=o),type:"date",placeholder:"选择成立日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(u,{label:"经营范围"},{default:l(()=>[t(i,{modelValue:s.businessScope,"onUpdate:modelValue":e[7]||(e[7]=o=>s.businessScope=o),type:"textarea",rows:3,placeholder:"请输入经营范围"},null,8,["modelValue"])]),_:1}),t(u,{label:"营业执照"},{default:l(()=>[t(i,{modelValue:s.licenseUrl,"onUpdate:modelValue":e[8]||(e[8]=o=>s.licenseUrl=o),placeholder:"营业执照图片URL（暂不支持上传）"},null,8,["modelValue"])]),_:1}),a.value&&a.value.status===3?(d(),f(u,{key:0},{default:l(()=>[t(S,{title:"驳回原因",description:a.value.rejectReason,type:"error","show-icon":"",closable:!1},null,8,["description"])]),_:1})):_("",!0),t(u,null,{default:l(()=>[t(x,{type:"primary",size:"large",onClick:z,loading:h.value},{default:l(()=>[...e[9]||(e[9]=[p("提交审核",-1)])]),_:1},8,["loading"]),t(x,{size:"large",onClick:A,loading:C.value},{default:l(()=>[...e[10]||(e[10]=[p("保存草稿",-1)])]),_:1},8,["loading"]),t(x,{size:"large",onClick:B},{default:l(()=>[...e[11]||(e[11]=[p("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(I,{span:8},{default:l(()=>[t(b,{header:"认证状态"},{default:l(()=>[a.value?(d(),U("div",le,[t(O,{column:1,border:""},{default:l(()=>[t(V,{label:"认证状态"},{default:l(()=>[t(Q,{type:F(a.value.status)},{default:l(()=>[p(v($(a.value.status)),1)]),_:1},8,["type"])]),_:1}),a.value.createTime?(d(),f(V,{key:0,label:"提交时间"},{default:l(()=>[p(v(D(a.value.createTime)),1)]),_:1})):_("",!0),a.value.reviewTime?(d(),f(V,{key:1,label:"审核时间"},{default:l(()=>[p(v(D(a.value.reviewTime)),1)]),_:1})):_("",!0),a.value.reviewer?(d(),f(V,{key:2,label:"审核人"},{default:l(()=>[p(v(a.value.reviewer),1)]),_:1})):_("",!0)]),_:1})])):(d(),U("div",ae,[t(G,{description:"尚未提交企业认证","image-size":80})]))]),_:1}),t(b,{header:"认证流程说明",style:{"margin-top":"20px"}},{default:l(()=>[t(H,{direction:"vertical",active:j(),"finish-status":"success"},{default:l(()=>[t(w,{title:"提交资料",description:"填写企业基本信息并上传执照"}),t(w,{title:"平台初审",description:"预计 1-2 个工作日"}),t(w,{title:"打款验证",description:"对公账户小额打款验证"}),t(w,{title:"认证通过",description:"解锁所有交易权限"})]),_:1},8,["active"])]),_:1}),t(b,{header:"常见问题",style:{"margin-top":"20px"}},{default:l(()=>[...e[12]||(e[12]=[g("p",{class:"faq-item"},"Q: 认证需要多长时间？",-1),g("p",{class:"faq-ans"},"A: 通常在提交后 3 个工作日内完成。",-1),g("p",{class:"faq-item"},"Q: 必须对公打款吗？",-1),g("p",{class:"faq-ans"},"A: 是的，这是为了验证企业银行账户的有效性。",-1)])]),_:1})]),_:1})]),_:1})])}}},ne=K(se,[["__scopeId","data-v-e666e69f"]]);export{ne as default};
