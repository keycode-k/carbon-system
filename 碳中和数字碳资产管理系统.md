# 碳中和数字碳资产管理系统

## 1. 项目简介

全球气候变化的影响正对全人类生存发展带来日益严峻的挑战，走向碳中和已成全球共识。数字技术能够与能源、工业等重点碳排放领域深度融合，有效提升能源与资源的使用效率，实现生产效率与碳效率的双提升，数字化正成为我国实现碳中和的重要技术路径。

对于大多数企业，碳管理仍是新的领域，企业缺乏对碳管理的基本知识，缺乏有效的工具来引导企业开始碳管理。碳中和数字碳资产管理系统，为用户提供碳资产管理、碳资产开发以及碳资产交易等功能，构建开放、透明的碳资产管理平台。通过数据分析技术，为客户进行碳交易提供依据，实现碳资产和交易信息的便捷管理。

项目综合运用软件工程、Vue前端框架、SpringBoot框架、Spring Cloud微服务等相关课程技术，采用前后端分离模式进行项目的开发和架构。

## 2. 技术架构

### 2.1 后端技术
- **开发语言**: Java
- **框架**: Spring Boot, Spring Cloud Alibaba (微服务架构)
- **数据库**: MySQL
- **ORM框架**: MyBatis Plus
- **中间件**: Redis, Nacos (注册中心/配置中心), Seata (分布式事务 - 可选), Sentinel (熔断降级 - 可选)
- **构建工具**: Maven

### 2.2 前端技术
- **框架**: Vue 3
- **构建工具**: Vite
- **语言**: JavaScript / TypeScript
- **UI组件库**: Element Plus (推荐)

## 3. 功能需求 (前端菜单结构)

项目前端菜单栏结构如下所示：

- **首页**: 系统概览与数据看板
- **账户管理**
    - 基本信息
    - 企业信息
- **碳资产管理**
    - 碳信用: 记录CCER等核证自愿减排量
    - 碳配额: 记录政府分配的排放配额
- **碳资产开发**
    - 方法学管理: 管理碳减排计算的方法学标准
    - 开发项目管理
        - 开发立项
        - 开发进度
    - 开发工作台
        - 项目开发实施
        - 项目文档管理
- **碳交易行情**
    - 供需行情: 展示市场供需数据
    - 询报价: 买卖双方发布意向
    - 交易所: 模拟交易撮合
    - 交易账户: 资金与持仓管理
- **碳资讯**: 行业新闻与政策发布
- **系统管理**
    - 平台运营管理
        - 账户管理
        - 租户管理
        - 资讯管理
        - 方法学管理
        - 项目库管理
        - 项目文档管理
        - 交易所管理
    - 基础配置管理
        - 角色管理
        - 字典管理
        - 菜单管理
    - 平台审批管理: 业务流程审批

## 4. 前端代码框架结构

```text
frontend/
├── public/                 # 公共静态资源
├── src/
│   ├── api/                # 后端接口请求定义 (如 user.js)
│   ├── layout/             # 页面布局组件
│   ├── router/             # 路由配置 (定义菜单跳转)
│   ├── store/              # 状态管理
│   ├── utils/              # 工具函数 (request.js Axios封装)
│   ├── views/              # 页面视图
│   │   ├── account/        # 账户管理
│   │   ├── assets/         # 碳资产管理
│   │   ├── dashboard/      # 首页看板
│   │   ├── development/    # 碳资产开发
│   │   ├── login/          # 登录页
│   │   ├── market/         # 碳交易行情
│   │   ├── news/           # 碳资讯
│   │   └── system/         # 系统管理
│   ├── App.vue             # 根组件
│   ├── main.js             # 入口文件
│   └── style.css           # 全局样式
├── package.json            # 依赖配置
└── vite.config.js          # Vite配置
```

## 5. 后端代码项目框架结构

项目规划采用完整的 Spring Cloud 微服务拆分架构，当前处于开发第一阶段，采用 **Consumer/Provider** 模式进行基础业务落地。

### 5.1 规划微服务架构 (Target Architecture)
此架构为项目最终演进目标，包含完善的服务拆分与治理：

```text
my-carbon-project/
├── carbon-auth             # [核心] 认证授权服务 (OAuth2 / JWT)
├── carbon-gate             # [核心] 服务网关 (Gateway)
├── carbon-system           # [核心] 系统基础服务 (用户, 角色, 菜单, 字典, 审批流)
├── carbon-assets           # [业务] 碳资产服务 (配额, 信用, 盘查)
├── carbon-trade            # [业务] 碳交易服务 (行情, 订单, 撮合)
├── carbon-mq               # [支撑] 消息服务 (异步通知, 业务解耦)
├── carbon-frame            # [基础] 框架依赖聚合
│   ├── carbon-common       # 公共工具类, 常量, 基础实体
│   └── carbon-common-model # 公共API模型 (Feign Client, VO, DTO)
```

### 5.2 当前开发物理架构 (Current Phase 1)
根据当前代码库 `carbon-system`，后端实现了 **Consumer (网关/消费端)** 与 **Provider (服务端)** 的双层结构，承载了系统的基础功能：

```text
carbon-system/              # 父工程
├── service-consumer        # [当前角色: 网关 + BFF层]
│   │   # 对应 target: carbon-gate + 部分 carbon-system controller
│   ├── src/main/java/com/example/consumer/
│   │   ├── controller/     # 统一对外API接口 (如 UserController)
│   │   ├── entity/         # 交互模型 (VO/DTO)
│   │   └── feign/          # Feign Client (如 UserFeignClient)
│   └── src/main/resources/
│       └── application.yml # 配置文件 (端口: 8082)
├── service-provider        # [当前角色: 业务聚合服务]
│   │   # 对应 target: carbon-system + (待扩充) carbon-assets/trade
│   ├── src/main/java/com/example/provider/
│   │   ├── controller/     # 内部微服务接口
│   │   ├── entity/         # 数据库实体 (User)
│   │   └── mapper/         # MyBatis持久层 (UserMapper)
│   └── src/main/resources/
│       └── application.yml # 配置文件 (端口: 8081)
└── pom.xml                 # 父工程依赖管理
```

### 5.3 功能模块演进与映射
将规划中的业务模块逐步落地到当前架构中：

1.  **用户认证 (User System)**
    *   *Theoretical*: `carbon-system` / `carbon-auth`
    *   *Actual*: 已在 `service-provider` 中实现 `UserController`, `UserMapper`，并集成 Redis 存储 Token。Consumer 通过 Feign 调用。

2.  **碳资产管理 (Assets)** [开发中]
    *   *Theoretical*: `carbon-assets`
    *   *Actual*: 已在 `service-provider` 中实现 **碳配额 (Quota)** 功能。
        *   DB: 新增 `carbon_quota` 表。
        *   后端: `CarbonQuotaController` 提供按年度查询和列表查询接口。
        *   前端: `quota.vue` 已接入 API，实现配额数据动态展示与自动计算盈余/使用率。

3.  **碳交易 (Trade)** [待开发]
    *   *Theoretical*: `carbon-trade`
    *   *Plan*: 建议在 `service-provider` 中实现 `com.example.provider.controller.trade` 及其对应数据库表。

### 5.4 关键类与技术实现
*   **服务发现**: Nacos (`132.226.64.96:8848`)
*   **服务调用**: OpenFeign (`UserFeignClient` -> `service-provider`)
*   **持久层**: MyBatis-Plus
*   **缓存**: Redis (`RedisTemplate`)

## 6. 后续开发建议

1.  **数据库设计**: 根据上述功能模块设计 MySQL 表结构，特别是 `carbon_assets` 和 `carbon_trade` 相关的业务表。
2.  **审批流**: 建议在 `carbon-system` 中设计一套简易的本地审批表 (`sys_approval_record`)，实现基础的业务审核流程。
3.  **交易撮合**: 简单的交易撮合逻辑可以在 `carbon-trade` 服务中通过数据库事务或 Redis 队列实现。


## 7. 鍚庣画璇︾粏寮€鍙戣鍒?(2026-01-06 Update)

缁撳悎褰撳墠椤圭洰杩涘害锛堝凡瀹屾垚鐢ㄦ埛鍩虹妯″潡涓庣⒊閰嶉妯″潡锛夛紝鍚庣画寮€鍙戝皢渚ч噸浜庡仴鍏ㄨ祫浜х鐞嗕笌寤虹珛浜ゆ槗甯傚満銆?

### 7.1 鏍稿績鍔熻兘鎵╁睍寤鸿

#### 鈶?寮€鍙?"纰充俊鐢?(CCER)" 妯″潡 (Assets)
*   **鍓嶇瀵瑰簲**: `frontend/src/views/assets/credit.vue`
*   **鐩爣**: 璁板綍鍜岀鐞嗕紒涓氱殑鏍歌瘉鑷効鍑忔帓閲?(CCER)銆?
*   **鍚庣画寮€鍙戜换鍔?*:
    *   **DB**: 鍒涘缓 `carbon_credit` 琛?(瀛楁: `project_id` 椤圭洰ID, `amount` 鏁伴噺, `status` (宸茬鍙?宸插喕缁?宸叉敞閿€), `expiry_date` 鏈夋晥鏈?銆?
    *   **Provider**: 瀹炵幇 CCER 鐨勫鍒犳敼鏌?Controller銆?
    *   **Consumer**: 鏆撮湶鏌ヨ API銆?
    *   **涓氬姟閫昏緫**: 闇€瀹炵幇涓?`User` 鐨勫叧鑱旓紝鏀寔鏌ョ湅褰撳墠璐︽埛鎸佹湁鐨?CCER 鎬婚噺銆?

#### 鈶?寮€鍙?"纰充氦鏄撳競鍦? 妯″潡 (Market)
*   **鍓嶇瀵瑰簲**: `frontend/src/views/market/exchange.vue` (浜ゆ槗澶у巺), `quotes.vue` (琛屾儏)
*   **鐩爣**: 瀹炵幇纰宠祫浜э紙閰嶉/CCER锛夌殑鑷敱涔板崠銆?
*   **寮€鍙戜换鍔?*:
    *   **DB**: 璁捐 `trade_order` (鎸傚崟琛? 鍜?`trade_record` (鎴愪氦璁板綍琛?銆?
    *   **Provider**: 缂栧啓鎾悎寮曟搸閫昏緫锛堢畝鍗曠殑涔板崠浠锋牸浼樺厛+鏃堕棿浼樺厛鍖归厤锛夈€?
    *   **Consumer**: 鎻愪緵涓嬪崟鎺ュ彛 `/api/market/order/place` 鍜岃鎯呮帴鍙ｃ€?

#### 鈶?瀹屽杽 "椤圭洰寮€鍙? 妯″潡 (Development)
*   **鍓嶇瀵瑰簲**: `frontend/src/views/development/project.vue`
*   **鐩爣**: 绠＄悊鍑忔帓椤圭洰鐨勭敵鎶ヤ笌绛惧彂娴佺▼銆?
*   **寮€鍙戜换鍔?*:
    *   璁捐椤圭洰鐘舵€佸鎵规祦锛歚Pending` (寰呭鏍? -> `Approved` (閫氳繃) -> `Issued` (宸茬鍙戣祫浜?銆?

### 7.2 鎶€鏈灦鏋勪紭鍖栧缓璁?

#### 鈶?瀹夊叏鎬у寮?
*   **API缃戝叧閴存潈**: 鍦?`service-consumer` 涓紩鍏ユ嫤鎴櫒锛屾嫤鎴?`/api/**` 璇锋眰锛岀粺涓€鏍￠獙 Header 涓殑 Token銆?
*   **鎺ュ彛鏉冮檺**: 鍖哄垎涓汉鐢ㄦ埛涓庝紒涓氱敤鎴锋潈闄愶紝闃叉瓒婃潈璁块棶銆?

#### 鈶?鏁版嵁搴撲笌瀹炰綋涓€鑷存€?
*   **瀛楁瀵归綈**: 鍚庣画鏂拌〃璁捐搴斾繚鎸?Java 瀹炰綋涓?DB 瀛楁鍛藉悕瑙勮寖涓€鑷达紙椹煎嘲杞笅鍒掔嚎锛夛紝閬垮厤绫讳技 `realName` vs `nickname` 鐨勬贩娣嗐€?

#### 鈶?鎺ュ彛鏂囨。
*   寤鸿寮曞叆 `Knife4j` 鎴?`Swagger`锛岃嚜鍔ㄧ敓鎴愭帴鍙ｆ枃妗ｏ紝闄嶄綆鍓嶅悗绔矡閫氭垚鏈€?
